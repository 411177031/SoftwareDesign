<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ç•¶å‰è¨‚å–®</title>
  <style>
    body {
      font-family: "Noto Sans TC", Arial, sans-serif;
      background-color: #f2f2f2;
      padding: 20px;
      margin: 0;
    }

    header {
      text-align: center;
      margin: 10px 0; /* ä¸Šä¸‹é‚Šè·ç¸®å°åˆ°10px */
      justify-content: center; /* è®“ header å…§å®¹åœ¨ä¸­é–“ */
      align-items: center;
      position: relative; /* è®“ .menu çš„çµ•å°å®šä½åŸºæº– */
      display: flex;
    }

    header h1 {
      font-size: 1.8rem; /* å­—é«”è®Šå°ï¼Œç´„ç­‰æ–¼ 28.8px */
      margin: 0;         /* å»æ‰h1æœ¬èº«çš„ä¸Šä¸‹é è¨­å¤–è· */
      font-weight: 700;  /* å¯è¦–éœ€è¦èª¿æ•´å­—é‡ */
      color: #222;
    }

    .menu {
      margin-right: 10px;
      position: relative;
    }

    .menu ul {
            list-style: none;
            padding: 5px 10px;
            margin: 0;
            background-color: rgba(255, 255, 255, 0.8); /* ç™½è‰²é€æ˜èƒŒæ™¯ */
            border-radius: 5px;
    }

    .menu button {
      font-size: 1.5em;
      background: transparent;
      border: none;
      color: #333; /* æ·±ç°è‰²ï¼Œå’Œé¸å–®é€£çµä¸€è‡´ */
      cursor: pointer;
    }

    #menuList {
      position: absolute;
      top: 100%;
      left: 0;
      background: rgba(255, 255, 255, 0.9);
      list-style: none;
      margin: 0;
      padding: 0.5em;
      display: none;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      border-radius: 4px;
      min-width: 120px; /* ğŸš€ åŠ é€™ä¸€è¡Œï¼Œçµ¦å€‹è¶³å¤ å¯¬åº¦ */
    }

    #menuList li {
      margin: 0.2em 0;
    }

    #menuList li a {
      color: #333;
      text-decoration: none;
    }

    #menuList li a:hover {
      color: #555;
    }

    .menu ul li a {
      color: #333; /* æ·±ç°è‰² */
      text-decoration: none;
      display: block;
      padding: 5px 0;
    }

    .menu ul li a:hover {
      color: #555; /* æ»‘é¼ æ‡¸åœè®Šæ›´è‰² */
    }

    #order-container {
      max-width: 800px;
      margin: 20px auto;
    }

    .order {
      background-color: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .order p {
      margin: 5px 0;
      color: #333;
    }

    ul {
      padding-left: 20px;
      margin: 10px 0;
    }

    li {
      margin-bottom: 5px;
    }

    .cancel-button {
      margin-top: 10px;
      padding: 8px 16px;
      background-color: #e74c3c;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    .cancel-button:hover {
      background-color: #c0392b;
    }

    p, li {
      font-size: 16px;
    }
  </style>
</head>
<body>
  <header>
    <div class="menu">
      <button id="menuButton">â˜°</button>
      <ul id="menuList" style="display: none;">
        <li><a href="index.html">é¦–é </a></li>
        <li><a href="order.html">é»å–®é é¢</a></li>
        <li><a href="current_order.html">ç•¶å‰è¨‚å–®</a></li>
        <li><a href="notification.html">é€šçŸ¥ä¸­å¿ƒ</a></li>
        <li><a href="history.html">è¨‚å–®ç´€éŒ„</a></li>
      </ul>
    </div>
    <h1>ç•¶å‰è¨‚å–®</h1>
  </header>

  <div id="order-container">
    <p>è¼‰å…¥ä¸­...</p>
  </div>

  <script>
    document.getElementById('menuButton').addEventListener('click', function() {
      const menuList = document.getElementById('menuList');
      menuList.style.display = (menuList.style.display === 'none') ? 'block' : 'none';
    });

    document.addEventListener("DOMContentLoaded", function () {
      const orders = JSON.parse(localStorage.getItem("orders")) || [];
      // åªä¿ç•™é€²è¡Œä¸­çš„è¨‚å–®
      const ongoingOrders = orders.filter(order => order.orderStatus === "é€²è¡Œä¸­");

      const orderContainer = document.getElementById("order-container");

      if (ongoingOrders.length === 0) {
        orderContainer.innerHTML = "<p>ç›®å‰æ²’æœ‰é€²è¡Œä¸­çš„è¨‚å–®ã€‚</p>";
        return;
      }

      orderContainer.innerHTML = "";
      ongoingOrders.forEach(order => {
        const orderDiv = document.createElement("div");
        orderDiv.className = "order";
        const totalAmount = order.orderItems.reduce(
          (sum, item) => sum + item.price * (item.quantity || 1),
          0
        );

        orderDiv.innerHTML = `
          <p><strong>è¨‚å–®ç·¨è™Ÿï¼š</strong>${order.orderID}</p>
          <p><strong>è¨‚å–®æ™‚é–“ï¼š</strong>${order.orderTime}</p>
          <p><strong>ç‹€æ…‹ï¼š</strong>${order.orderStatus}</p>
          <p><strong>å“é …ï¼š</strong></p>
          <ul>
            ${order.orderItems.map(item => `
              <li>${item.name} x ${item.quantity || 1}ï¼ˆ$${item.price * (item.quantity || 1)}ï¼‰</li>
            `).join("")}
          </ul>
          <p><strong>ç¸½é‡‘é¡ï¼š</strong>$${totalAmount}</p>
        `;

        const cancelButton = document.createElement("button");
        cancelButton.textContent = "å–æ¶ˆè¨‚å–®";
        cancelButton.classList.add("cancel-button"); // åŠ ä¸Šé¡åˆ¥
        cancelButton.onclick = function () {
          cancelOrder(order.orderID);
        };
        orderDiv.appendChild(cancelButton);

        orderContainer.appendChild(orderDiv);
      });

      function cancelOrder(orderID) {
        if (confirm("ç¢ºå®šè¦å–æ¶ˆé€™ç­†è¨‚å–®å—ï¼Ÿ")) {
          const updatedOrders = orders.map(order => {
            if (order.orderID === orderID) {
              return { ...order, orderStatus: "å·²å–æ¶ˆ" };
            }
            return order;
          });

          localStorage.setItem("orders", JSON.stringify(updatedOrders));
          alert("è¨‚å–®å·²å–æ¶ˆ");
          location.reload();
        }
      }
    });
  </script>

</body>
</html>
